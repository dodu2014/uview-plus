var t=Object.defineProperty,s=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(s,e,i)=>e in s?t(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i;import{j as n,s as r,o,c as l,w as h,b as c,r as d,F as p,q as m,n as g,p as u,u as f,f as y,t as b,a as x,e as v,g as k,i as w,B as T,C as _,l as N}from"./index.29fdcc6f.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";var O={props:{content:String,copyLink:{type:Boolean,default:n.parse.copyLink},domain:String,errorImg:{type:String,default:n.parse.errorImg},lazyLoad:{type:Boolean,default:n.parse.lazyLoad},loadingImg:{type:String,default:n.parse.loadingImg},pauseVideo:{type:Boolean,default:n.parse.pauseVideo},previewImg:{type:Boolean,default:n.parse.previewImg},scrollTable:Boolean,selectable:Boolean,setTitle:{type:Boolean,default:n.parse.setTitle},showImgMenu:{type:Boolean,default:n.parse.showImgMenu},tagStyle:Object,useAnchor:null}};const I={trustTags:j("a,abbr,ad,audio,b,blockquote,br,code,col,colgroup,dd,del,dl,dt,div,em,fieldset,h1,h2,h3,h4,h5,h6,hr,i,img,ins,label,legend,li,ol,p,q,ruby,rt,source,span,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,title,ul,video"),blockTags:j("address,article,aside,body,caption,center,cite,footer,header,html,nav,pre,section"),ignoreTags:j("area,base,canvas,embed,frame,head,iframe,input,link,map,meta,param,rp,script,source,style,textarea,title,track,wbr"),voidTags:j("area,base,br,col,circle,ellipse,embed,frame,hr,img,input,line,link,meta,param,path,polygon,rect,source,track,use,wbr"),entities:{lt:"<",gt:">",quot:'"',apos:"'",ensp:" ",emsp:" ",nbsp:" ",semi:";",ndash:"–",mdash:"—",middot:"·",lsquo:"‘",rsquo:"’",ldquo:"“",rdquo:"”",bull:"•",hellip:"…"},tagStyle:{address:"font-style:italic",big:"display:inline;font-size:1.2em",caption:"display:table-caption;text-align:center",center:"text-align:center",cite:"font-style:italic",dd:"margin-left:40px",mark:"background-color:yellow",pre:"font-family:monospace;white-space:pre",s:"text-decoration:line-through",small:"display:inline;font-size:0.8em",u:"text-decoration:underline"}},{windowWidth:L}=uni.getSystemInfoSync(),C=j(" ,\r,\n,\t,\f");let S=0;function j(t){const s=Object.create(null),e=t.split(",");for(let i=e.length;i--;)s[e[i]]=!0;return s}function A(t,s){let e=t.indexOf("&");for(;-1!=e;){const i=t.indexOf(";",e+3);let a;if(-1==i)break;"#"==t[e+1]?(a=parseInt(("x"==t[e+2]?"0":"")+t.substring(e+2,i)),isNaN(a)||(t=t.substr(0,e)+String.fromCharCode(a)+t.substr(i+1))):(a=t.substring(e+1,i),(I.entities[a]||"amp"==a&&s)&&(t=t.substr(0,e)+(I.entities[a]||"&")+t.substr(i+1))),e=t.indexOf("&",e+1)}return t}I.ignoreTags.iframe=void 0,I.trustTags.iframe=!0,I.ignoreTags.embed=void 0,I.trustTags.embed=!0;class z{constructor(t){this.options=t||{},this.tagStyle=Object.assign(I.tagStyle,this.options.tagStyle),this.imgList=t.imgList||[],this.plugins=t.plugins||[],this.attrs=Object.create(null),this.stack=[],this.nodes=[]}parse(t){for(let s=this.plugins.length;s--;)this.plugins[s].onUpdate&&(t=this.plugins[s].onUpdate(t,I)||t);for(new V(this).parse(t);this.stack.length;)this.popNode();return this.nodes}expose(){for(let t=this.stack.length;t--;){const s=this.stack[t];if("a"==s.name||s.c)return;s.c=1}}hook(t){for(let s=this.plugins.length;s--;)if(this.plugins[s].onParse&&0==this.plugins[s].onParse(t,this))return!1;return!0}getUrl(t){const{domain:s}=this.options;return"/"==t[0]?"/"==t[1]?t=`${s?s.split("://")[0]:"http"}:${t}`:s&&(t=s+t):!s||t.includes("data:")||t.includes("://")||(t=`${s}/${t}`),t}parseStyle(t){const{attrs:s}=t,e=(this.tagStyle[t.name]||"").split(";").concat((s.style||"").split(";")),i={};let a="";s.id&&(this.options.useAnchor?this.expose():"img"!=t.name&&"a"!=t.name&&"video"!=t.name&&"audio"!=t.name&&(s.id=void 0)),s.width&&(i.width=parseFloat(s.width)+(s.width.includes("%")?"%":"px"),s.width=void 0),s.height&&(i.height=parseFloat(s.height)+(s.height.includes("%")?"%":"px"),s.height=void 0);for(let n=0,r=e.length;n<r;n++){const t=e[n].split(":");if(t.length<2)continue;const s=t.shift().trim().toLowerCase();let r=t.join(":").trim();if("-"==r[0]&&r.lastIndexOf("-")>0||r.includes("safe"))a+=";".concat(s,":").concat(r);else if(!i[s]||r.includes("import")||!i[s].includes("import")){if(r.includes("url")){let t=r.indexOf("(")+1;if(t){for(;'"'==r[t]||"'"==r[t]||C[r[t]];)t++;r=r.substr(0,t)+this.getUrl(r.substr(t))}}else r.includes("rpx")&&(r=r.replace(/[0-9.]+\s*rpx/g,(t=>parseFloat(t)*L/750+"px")));i[s]=r}}return t.attrs.style=a,i}onTagName(t){this.tagName=this.xml?t:t.toLowerCase(),"svg"==this.tagName&&(this.xml=!0)}onAttrName(t){"data-"==(t=this.xml?t:t.toLowerCase()).substr(0,5)?"data-src"!=t||this.attrs.src?"img"==this.tagName||"a"==this.tagName?this.attrName=t:this.attrName=void 0:this.attrName="src":(this.attrName=t,this.attrs[t]="T")}onAttrVal(t){const s=this.attrName||"";"style"==s||"href"==s?this.attrs[s]=A(t,!0):s.includes("src")?this.attrs[s]=this.getUrl(A(t,!0)):s&&(this.attrs[s]=t)}onOpenTag(t){const s=Object.create(null);s.name=this.tagName,s.attrs=this.attrs,this.attrs=Object.create(null);const{attrs:e}=s,i=this.stack[this.stack.length-1],a=i?i.children:this.nodes,n=this.xml?t:I.voidTags[s.name];if("embed"==s.name&&this.expose(),"video"!=s.name&&"audio"!=s.name||("video"!=s.name||e.id||(e.id="v"+S++),e.controls||e.autoplay||(e.controls="T"),s.src=[],e.src&&(s.src.push(e.src),e.src=void 0),this.expose()),n){if(!this.hook(s)||I.ignoreTags[s.name])return void("base"!=s.name||this.options.domain?"source"==s.name&&i&&("video"==i.name||"audio"==i.name)&&e.src&&i.src.push(e.src):this.options.domain=e.href);const t=this.parseStyle(s);if("img"==s.name){if(e.src&&(e.src.includes("webp")&&(s.webp="T"),e.src.includes("data:")&&!e["original-src"]&&(e.ignore="T"),!e.ignore||s.webp||e.src.includes("cloud://"))){for(let e=this.stack.length;e--;){const t=this.stack[e];if("a"==t.name){s.a=t.attrs;break}t.c=1}e.i=this.imgList.length.toString();let t=e["original-src"]||e.src;this.imgList.push(t),this.options.lazyLoad&&(e["data-src"]=e.src,e.src=void 0)}"inline"==t.display&&(t.display=""),e.ignore&&(t["max-width"]=t["max-width"]||"100%",e.style+=";-webkit-touch-callout:none"),parseInt(t.width)>L&&(t.height=void 0),t.width&&(t.width.includes("auto")?t.width="":(s.w="T",t.height&&!t.height.includes("auto")&&(s.h="T")))}else if("svg"==s.name)return a.push(s),this.stack.push(s),void this.popNode();for(const s in t)t[s]&&(e.style+=";".concat(s,":").concat(t[s].replace(" !important","")));e.style=e.style.substr(1)||void 0}else("pre"==s.name||(e.style||"").includes("white-space")&&e.style.includes("pre"))&&(this.pre=s.pre=!0),s.children=[],this.stack.push(s);a.push(s)}onCloseTag(t){let s;for(t=this.xml?t:t.toLowerCase(),s=this.stack.length;s--&&this.stack[s].name!=t;);if(-1!=s)for(;this.stack.length>s;)this.popNode();else if("p"==t||"br"==t){(this.stack.length?this.stack[this.stack.length-1].children:this.nodes).push({name:t,attrs:{}})}}popNode(){const t=this.stack.pop();let{attrs:n}=t;const{children:r}=t,o=this.stack[this.stack.length-1],l=o?o.children:this.nodes;if(!this.hook(t)||I.ignoreTags[t.name])return"title"==t.name&&r.length&&"text"==r[0].type&&this.options.setTitle&&uni.setNavigationBarTitle({title:r[0].text}),void l.pop();if(t.pre){t.pre=this.pre=void 0;for(let t=this.stack.length;t--;)this.stack[t].pre&&(this.pre=!0)}const h={};if("svg"==t.name){let s="";const{style:e}=n;return n.style="",n.xmlns="http://www.w3.org/2000/svg",function t(e){s+=`<${e.name}`;for(let i in e.attrs){const t=e.attrs[i];t&&("viewbox"==i&&(i="viewBox"),s+=" ".concat(i,'="').concat(t,'"'))}if(e.children){s+=">";for(let s=0;s<e.children.length;s++)t(e.children[s]);s+=`</${e.name}>`}else s+="/>"}(t),t.name="img",t.attrs={src:`data:image/svg+xml;utf8,${s.replace(/#/g,"%23")}`,style:e,ignore:"T"},t.children=void 0,void(this.xml=!1)}if(n.align&&("table"==t.name?"center"==n.align?h["margin-inline-start"]=h["margin-inline-end"]="auto":h.float=n.align:h["text-align"]=n.align,n.align=void 0),"font"==t.name&&(n.color&&(h.color=n.color,n.color=void 0),n.face&&(h["font-family"]=n.face,n.face=void 0),n.size)){let t=parseInt(n.size);isNaN(t)||(t<1?t=1:t>7&&(t=7),h["font-size"]=["xx-small","x-small","small","medium","large","x-large","xx-large"][t-1]),n.size=void 0}if((n.class||"").includes("align-center")&&(h["text-align"]="center"),Object.assign(h,this.parseStyle(t)),parseInt(h.width)>L&&(h["max-width"]="100%",h["box-sizing"]="border-box"),I.blockTags[t.name]?t.name="div":I.trustTags[t.name]||this.xml||(t.name="span"),"a"==t.name||"ad"==t.name||"iframe"==t.name)this.expose();else if("ul"!=t.name&&"ol"!=t.name||!t.c){if("table"==t.name){let o=parseFloat(n.cellpadding),l=parseFloat(n.cellspacing);const c=parseFloat(n.border);if(t.c&&(isNaN(o)&&(o=2),isNaN(l)&&(l=2)),c&&(n.style+=`;border:${c}px solid gray`),t.flag&&t.c){h.display="grid",l?(h["grid-gap"]=`${l}px`,h.padding=`${l}px`):c&&(n.style+=";border-left:0;border-top:0");const s=[],e=[],i=[],a={};!function t(s){for(let i=0;i<s.length;i++)"tr"==s[i].name?e.push(s[i]):t(s[i].children||[])}(r);for(let t=1;t<=e.length;t++){let n=1;for(let r=0;r<e[t-1].children.length;r++,n++){const h=e[t-1].children[r];if("td"==h.name||"th"==h.name){for(;a[`${t}.${n}`];)n++;let e=h.attrs.style||"";const r=e.indexOf("width")?e.indexOf(";width"):0;if(-1!=r){let t=e.indexOf(";",r+6);-1==t&&(t=e.length),h.attrs.colspan||(s[n]=e.substring(r?r+7:6,t)),e=e.substr(0,r)+e.substr(t)}if(e+=(c?";border:".concat(c,"px solid gray")+(l?"":";border-right:0;border-bottom:0"):"")+(o?";padding:".concat(o,"px"):""),h.attrs.colspan&&(e+=";grid-column-start:".concat(n,";grid-column-end:").concat(n+parseInt(h.attrs.colspan)),h.attrs.rowspan||(e+=";grid-row-start:".concat(t,";grid-row-end:").concat(t+1)),n+=parseInt(h.attrs.colspan)-1),h.attrs.rowspan){e+=";grid-row-start:".concat(t,";grid-row-end:").concat(t+parseInt(h.attrs.rowspan)),h.attrs.colspan||(e+=";grid-column-start:".concat(n,";grid-column-end:").concat(n+1));for(let s=1;s<h.attrs.rowspan;s++)a[`${t+s}.${n}`]=1}e&&(h.attrs.style=e),i.push(h)}}if(1==t){let t="";for(let e=1;e<n;e++)t+=`${s[e]?s[e]:"auto"} `;h["grid-template-columns"]=t}}t.children=i}else t.c&&(h.display="table"),isNaN(l)||(h["border-spacing"]=`${l}px`),(c||o)&&function t(s){for(let e=0;e<s.length;e++){const i=s[e];"th"==i.name||"td"==i.name?(c&&(i.attrs.style="border:".concat(c,"px solid gray;").concat(i.attrs.style||"")),o&&(i.attrs.style="padding:".concat(o,"px;").concat(i.attrs.style||""))):i.children&&t(i.children)}}(r);if(this.options.scrollTable&&!(n.style||"").includes("inline")){const r=((t,n)=>{for(var r in n||(n={}))e.call(n,r)&&a(t,r,n[r]);if(s)for(var r of s(n))i.call(n,r)&&a(t,r,n[r]);return t})({},t);t.name="div",t.attrs={style:"overflow:auto"},t.children=[r],n=r.attrs}}else if("td"!=t.name&&"th"!=t.name||!n.colspan&&!n.rowspan){if("ruby"==t.name){t.name="span";for(let t=0;t<r.length-1;t++)"text"==r[t].type&&"rt"==r[t+1].name&&(r[t]={name:"div",attrs:{style:"display:inline-block"},children:[{name:"div",attrs:{style:"font-size:50%;text-align:start"},children:r[t+1].children},r[t]]},r.splice(t+1,1))}else if(t.c){t.c=2;for(let s=t.children.length;s--;)t.children[s].c&&"table"!=t.children[s].name||(t.c=1)}}else for(let s=this.stack.length;s--;)if("table"==this.stack[s].name){this.stack[s].flag=1;break}}else{const t={a:"lower-alpha",A:"upper-alpha",i:"lower-roman",I:"upper-roman"};t[n.type]&&(n.style+=`;list-style-type:${t[n.type]}`,n.type=void 0);for(let s=r.length;s--;)"li"==r[s].name&&(r[s].c=1)}if((h.display||"").includes("flex")&&!t.c)for(let s=r.length;s--;){const t=r[s];t.f&&(t.attrs.style=(t.attrs.style||"")+t.f,t.f=void 0)}const c=o&&(o.attrs.style||"").includes("flex")&&!t.c;c&&(t.f=";max-width:100%");for(const s in h)if(h[s]){const e=";".concat(s,":").concat(h[s].replace(" !important",""));c&&(s.includes("flex")&&"flex-direction"!=s||"align-self"==s||"-"==h[s][0]||"width"==s&&e.includes("%"))?(t.f+=e,"width"==s&&(n.style+=";width:100%")):n.style+=e}n.style=n.style.substr(1)||void 0}onText(t){if(!this.pre){let s,e="";for(let i=0,a=t.length;i<a;i++)C[t[i]]?(" "!=e[e.length-1]&&(e+=" "),"\n"!=t[i]||s||(s=!0)):e+=t[i];if(" "==e&&s)return;t=e}const s=Object.create(null);if(s.type="text",s.text=A(t),this.hook(s)){(this.stack.length?this.stack[this.stack.length-1].children:this.nodes).push(s)}}}function V(t){this.handler=t}V.prototype.parse=function(t){this.content=t||"",this.i=0,this.start=0,this.state=this.text;for(let s=this.content.length;-1!=this.i&&this.i<s;)this.state()},V.prototype.checkClose=function(t){const s="/"==this.content[this.i];return!!(">"==this.content[this.i]||s&&">"==this.content[this.i+1])&&(t&&this.handler[t](this.content.substring(this.start,this.i)),this.i+=s?2:1,this.start=this.i,this.handler.onOpenTag(s),"script"==this.handler.tagName?(this.i=this.content.indexOf("</",this.i),-1!=this.i&&(this.i+=2,this.start=this.i),this.state=this.endTag):this.state=this.text,!0)},V.prototype.text=function(){if(this.i=this.content.indexOf("<",this.i),-1==this.i)return void(this.start<this.content.length&&this.handler.onText(this.content.substring(this.start,this.content.length)));const t=this.content[this.i+1];if(t>="a"&&t<="z"||t>="A"&&t<="Z")this.start!=this.i&&this.handler.onText(this.content.substring(this.start,this.i)),this.start=++this.i,this.state=this.tagName;else if("/"==t||"!"==t||"?"==t){this.start!=this.i&&this.handler.onText(this.content.substring(this.start,this.i));const s=this.content[this.i+2];if("/"==t&&(s>="a"&&s<="z"||s>="A"&&s<="Z"))return this.i+=2,this.start=this.i,this.state=this.endTag;let e="--\x3e";"!"==t&&"-"==this.content[this.i+2]&&"-"==this.content[this.i+3]||(e=">"),this.i=this.content.indexOf(e,this.i),-1!=this.i&&(this.i+=e.length,this.start=this.i)}else this.i++},V.prototype.tagName=function(){if(C[this.content[this.i]]){for(this.handler.onTagName(this.content.substring(this.start,this.i));C[this.content[++this.i]];);this.i<this.content.length&&!this.checkClose()&&(this.start=this.i,this.state=this.attrName)}else this.checkClose("onTagName")||this.i++},V.prototype.attrName=function(){let t=this.content[this.i];if(C[t]||"="==t){this.handler.onAttrName(this.content.substring(this.start,this.i));let s="="==t;const e=this.content.length;for(;++this.i<e;)if(t=this.content[this.i],!C[t]){if(this.checkClose())return;if(s)return this.start=this.i,this.state=this.attrVal;if("="!=this.content[this.i])return this.start=this.i,this.state=this.attrName;s=!0}}else this.checkClose("onAttrName")||this.i++},V.prototype.attrVal=function(){const t=this.content[this.i],s=this.content.length;if('"'==t||"'"==t){if(this.start=++this.i,this.i=this.content.indexOf(t,this.i),-1==this.i)return;this.handler.onAttrVal(this.content.substring(this.start,this.i))}else for(;this.i<s;this.i++){if(C[this.content[this.i]]){this.handler.onAttrVal(this.content.substring(this.start,this.i));break}if(this.checkClose("onAttrVal"))return}for(;C[this.content[++this.i]];);this.i<s&&!this.checkClose()&&(this.start=this.i,this.state=this.attrName)},V.prototype.endTag=function(){const t=this.content[this.i];if(C[t]||">"==t||"/"==t){if(this.handler.onCloseTag(this.content.substring(this.start,this.i)),">"!=t&&(this.i=this.content.indexOf(">",this.i),-1==this.i))return;this.start=++this.i,this.state=this.text}else this.i++};var B={abbr:!0,b:!0,big:!0,code:!0,del:!0,em:!0,i:!0,ins:!0,label:!0,q:!0,small:!0,span:!0,strong:!0,sub:!0,sup:!0};const q={use:function(t){return!B[t.name]&&-1==(t.attrs.style||"").indexOf("display:inline")&&!t.c}};var P=t=>{t.$wxs||(t.$wxs=[]),t.$wxs.push("handler"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.handler=q}})};const E={name:"node",data:()=>({ctrl:{}}),props:{name:String,attrs:{type:Object,default:()=>({})},childs:Array,opts:Array},components:{},mounted(){for(this.root=this.$parent;"mp-html"!=this.root.$options.name;this.root=this.root.$parent);if(this.opts[0]){for(var t=this.childs.length;t--&&"img"!=this.childs[t].name;);-1!=t&&(this.observer=uni.createIntersectionObserver(this).relativeToViewport({top:500,bottom:500}),this.observer.observe("._img",(t=>{t.intersectionRatio&&(this.$set(this.ctrl,"load",1),this.observer.disconnect())})))}},beforeDestroy(){this.observer&&this.observer.disconnect()},methods:{play(t){if(this.root.pauseVideo){for(var s=!1,e=t.target.id,i=this.root._videos.length;i--;)this.root._videos[i].id==e?s=!0:this.root._videos[i].pause();if(!s){var a=uni.createVideoContext(e,this);a.id=e,this.root._videos.push(a)}}},imgTap(t){var s=this.childs[t.currentTarget.dataset.i];if(s.a)return this.linkTap(s.a);s.attrs.ignore||(s.attrs.src=s.attrs.src||s.attrs["data-src"],this.root.$emit("imgTap",s.attrs),this.root.previewImg&&uni.previewImage({current:parseInt(s.attrs.i),urls:this.root.imgList}))},imgLongTap(t){},imgLoad(t){var s=t.currentTarget.dataset.i;(this.opts[1]&&!this.ctrl[s]||-1==this.ctrl[s])&&this.$set(this.ctrl,s,1)},linkTap(t){var s=t.currentTarget?this.childs[t.currentTarget.dataset.i].attrs:t,e=s.href;this.root.$emit("linkTap",s),e&&("#"==e[0]?this.root.navigateTo(e.substring(1)).catch((()=>{})):e.includes("://")?this.root.copyLink&&window.open(e):uni.navigateTo({url:e,fail(){uni.switchTab({url:e,fail(){}})}}))},mediaError(t){var s=t.currentTarget.dataset.i,e=this.childs[s];if("video"==e.name||"audio"==e.name){var i=(this.ctrl[s]||0)+1;if(i>e.src.length&&(i=0),i<e.src.length)return this.$set(this.ctrl,s,i)}else"img"==e.name&&this.opts[2]&&this.$set(this.ctrl,s,-1);this.root&&this.root.$emit("error",{source:e.name,attrs:e.attrs,errMsg:t.detail.errMsg})}}};P(E);const F=[];var R=$({name:"mp-html",data:()=>({nodes:[]}),mixins:[O],components:{node:$(E,[["render",function(t,s,e,i,a,n){const N=v,$=k,O=r("node",!0),I=w,L=T,C=_;return o(),l(I,{id:e.attrs.id,class:u("_"+e.name+" "+e.attrs.class),style:m(e.attrs.style)},{default:h((()=>[(o(!0),c(p,null,d(e.childs,((i,r)=>(o(),c(p,{key:r},["img"==i.name&&(e.opts[1]&&!a.ctrl[r]||a.ctrl[r]<0)?(o(),l(N,{key:0,class:"_img",style:m(i.attrs.style),src:a.ctrl[r]<0?e.opts[2]:e.opts[1],mode:"widthFix"},null,8,["style","src"])):g("",!0),"img"==i.name?(o(),c("img",{key:1,id:i.attrs.id,class:u("_img "+i.attrs.class),style:m((-1==a.ctrl[r]?"display:none;":"")+i.attrs.style),src:i.attrs.src||(a.ctrl.load?i.attrs["data-src"]:""),"data-i":r,onLoad:s[0]||(s[0]=(...t)=>n.imgLoad&&n.imgLoad(...t)),onError:s[1]||(s[1]=(...t)=>n.mediaError&&n.mediaError(...t)),onClick:s[2]||(s[2]=f(((...t)=>n.imgTap&&n.imgTap(...t)),["stop"])),onLongpress:s[3]||(s[3]=(...t)=>n.imgLongTap&&n.imgLongTap(...t))},null,46,["id","src","data-i"])):"text"==i.type?(o(),l($,{key:2,decode:""},{default:h((()=>[y(b(i.text),1)])),_:2},1024)):"br"==i.name?(o(),l($,{key:3},{default:h((()=>[y("\\n")])),_:1})):"a"==i.name?(o(),l(I,{key:4,id:i.attrs.id,class:u((i.attrs.href?"_a ":"")+i.attrs.class),"hover-class":"_hover",style:m("display:inline;"+i.attrs.style),"data-i":r,onClick:f(n.linkTap,["stop"])},{default:h((()=>[x(O,{name:"span",childs:i.children,opts:e.opts,style:{display:"inherit"}},null,8,["childs","opts"])])),_:2},1032,["id","class","style","data-i","onClick"])):"video"==i.name?(o(),l(L,{key:5,id:i.attrs.id,class:u(i.attrs.class),style:m(i.attrs.style),autoplay:i.attrs.autoplay,controls:i.attrs.controls,loop:i.attrs.loop,muted:i.attrs.muted,poster:i.attrs.poster,src:i.src[a.ctrl[r]||0],"data-i":r,onPlay:n.play,onError:n.mediaError},null,8,["id","class","style","autoplay","controls","loop","muted","poster","src","data-i","onPlay","onError"])):"iframe"==i.name?(o(),c("iframe",{key:6,style:m(i.attrs.style),allowfullscreen:i.attrs.allowfullscreen,frameborder:i.attrs.frameborder,src:i.attrs.src},null,12,["allowfullscreen","frameborder","src"])):"embed"==i.name?(o(),c("embed",{key:7,style:m(i.attrs.style),src:i.attrs.src},null,12,["src"])):"table"==i.name&&i.c||"li"==i.name?(o(),l(I,{key:8,id:i.attrs.id,class:u("_"+i.name+" "+i.attrs.class),style:m(i.attrs.style)},{default:h((()=>["li"==i.name?(o(),l(O,{key:0,childs:i.children,opts:e.opts},null,8,["childs","opts"])):(o(!0),c(p,{key:1},d(i.children,((t,s)=>(o(),l(I,{key:s,class:u("_"+t.name+" "+t.attrs.class),style:m(t.attrs.style)},{default:h((()=>["td"==t.name||"th"==t.name?(o(),l(O,{key:0,childs:t.children,opts:e.opts},null,8,["childs","opts"])):(o(!0),c(p,{key:1},d(t.children,((t,s)=>(o(),c(p,{key:s},["td"==t.name||"th"==t.name?(o(),l(I,{key:0,class:u("_"+t.name+" "+t.attrs.class),style:m(t.attrs.style)},{default:h((()=>[x(O,{childs:t.children,opts:e.opts},null,8,["childs","opts"])])),_:2},1032,["class","style"])):(o(),l(I,{key:1,class:u("_"+t.name+" "+t.attrs.class),style:m(t.attrs.style)},{default:h((()=>[(o(!0),c(p,null,d(t.children,((t,s)=>(o(),l(I,{key:s,class:u("_"+t.name+" "+t.attrs.class),style:m(t.attrs.style)},{default:h((()=>[x(O,{childs:t.children,opts:e.opts},null,8,["childs","opts"])])),_:2},1032,["class","style"])))),128))])),_:2},1032,["class","style"]))],64)))),128))])),_:2},1032,["class","style"])))),128))])),_:2},1032,["id","class","style"])):t.handler.use(i)?(o(),l(C,{key:9,id:i.attrs.id,style:m(i.f),nodes:[i]},null,8,["id","style","nodes"])):2==i.c?(o(),l(I,{key:10,id:i.attrs.id,class:u("_"+i.name+" "+i.attrs.class),style:m(i.f+";"+i.attrs.style)},{default:h((()=>[(o(!0),c(p,null,d(i.children,((t,s)=>(o(),l(O,{key:s,style:m(t.f),name:t.name,attrs:t.attrs,childs:t.children,opts:e.opts},null,8,["style","name","attrs","childs","opts"])))),128))])),_:2},1032,["id","class","style"])):(o(),l(O,{key:11,style:m(i.f),name:i.name,attrs:i.attrs,childs:i.children,opts:e.opts},null,8,["style","name","attrs","childs","opts"]))],64)))),128))])),_:1},8,["id","class","style"])}],["__scopeId","data-v-20069803"]])},watch:{content(t){this.setContent(t)}},created(){this.plugins=[];for(let t=F.length;t--;)this.plugins.push(new F[t](this))},mounted(){this.content&&!this.nodes.length&&this.setContent(this.content)},beforeDestroy(){this._hook("onDetached"),clearInterval(this._timer)},methods:{in(t,s,e){t&&s&&e&&(this._in={page:t,selector:s,scrollTop:e})},navigateTo(t,s){return new Promise(((e,i)=>{if(!this.useAnchor)return i("Anchor is disabled");s=s||parseInt(this.useAnchor)||0;const a=uni.createSelectorQuery().in(this._in?this._in.page:this).select((this._in?this._in.selector:"._root")+(t?` #${t}`:"")).boundingClientRect();this._in?a.select(this._in.selector).scrollOffset().select(this._in.selector).boundingClientRect():a.selectViewport().scrollOffset(),a.exec((t=>{if(!t[0])return i("Label not found");const a=t[1].scrollTop+t[0].top-(t[2]?t[2].top:0)+s;this._in?this._in.page[this._in.scrollTop]=a:uni.pageScrollTo({scrollTop:a,duration:300}),e()}))}))},getText(){let t="";return function s(e){for(let i=0;i<e.length;i++){const a=e[i];if("text"==a.type)t+=a.text.replace(/&amp;/g,"&");else if("br"==a.name)t+="\n";else{const e="p"==a.name||"div"==a.name||"tr"==a.name||"li"==a.name||"h"==a.name[0]&&a.name[1]>"0"&&a.name[1]<"7";e&&t&&"\n"!=t[t.length-1]&&(t+="\n"),a.children&&s(a.children),e&&"\n"!=t[t.length-1]?t+="\n":"td"!=a.name&&"th"!=a.name||(t+="\t")}}}(this.nodes),t},getRect(){return new Promise(((t,s)=>{uni.createSelectorQuery().in(this).select("#_root").boundingClientRect().exec((e=>e[0]?t(e[0]):s("Root label not found")))}))},setContent(t,s){s&&this.imgList||(this.imgList=[]);const e=new z(this).parse(t);let i;this.$set(this,"nodes",s?(this.nodes||[]).concat(e):e),this._videos=[],this.$nextTick((()=>{this._hook("onLoad"),this.$emit("load")})),clearInterval(this._timer),this._timer=setInterval((()=>{this.getRect().then((t=>{t.height==i&&(this.$emit("ready",t),clearInterval(this._timer)),i=t.height})).catch((()=>{}))}),350)},_hook(t){for(let s=F.length;s--;)this.plugins[s][t]&&this.plugins[s][t]()}}},[["render",function(t,s,e,i,a,n){const c=r("node"),d=w;return o(),l(d,{id:"_root",class:u((t.selectable?"_select ":"")+"_root")},{default:h((()=>[a.nodes[0]?(o(),l(c,{key:1,childs:a.nodes,opts:[t.lazyLoad,t.loadingImg,t.errorImg,t.showImgMenu]},null,8,["childs","opts"])):N(t.$slots,"default",{key:0},void 0,!0)])),_:3},8,["class"])}],["__scopeId","data-v-fb142bf4"]]);export{R as _};
